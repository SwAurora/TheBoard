<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fusion.service.BoardMapper">
<!--    <resultMap type="com.fusion.domain.BoardVO" id="board">-->
<!--        <id column="B_NO" property="b_no"/>-->
<!--        <result column="TITLE" property="title"/>-->
<!--        <result column="CONTENT" property="content"/>-->
<!--        <result column="WRITER" property="writer"/>-->
<!--        <result column="REGDATE" property="regdate"/>-->
<!--        <result column="VIEWCNT" property="viewcnt"/>-->
<!--        <result column="TYPE" property="type"/>-->
<!--        <result column="DEL" property="del"/>-->
<!--    </resultMap>-->

    <select id="getBoardList" parameterType="map" resultType="com.fusion.domain.BoardVO">
        SELECT B.b_no,
               B.title,
               B.content,
               M.name as writer,
               B.regdate,
               B.viewcnt,
               B.type,
               B.del
        FROM (SELECT b_no,
                     title,
                     content,
                     writer,
                     regdate,
                     viewcnt,
                     type,
                     del
              FROM BOARD_TBL
              WHERE del = 'N'
                AND type = '1'
              ORDER BY b_no DESC) B
                 INNER JOIN MEMBER_TBL M ON WRITER = M_NO
        OFFSET ${start} ROWS FETCH FIRST ${row} ROWS ONLY
    </select>

    <select id="getTotalCount" resultType="int">
        SELECT SUM(1)
          FROM BOARD_TBL
         WHERE EXISTS(
            SELECT *
              FROM BOARD_TBL
             WHERE TYPE = '1'
               AND DEL = 'N'
        )
    </select>
</mapper>